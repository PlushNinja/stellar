/*!
 * froala_editor v1.2.8 (https://www.froala.com/wysiwyg-editor)
 * License https://www.froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(e){e.Editable.commands=e.extend(e.Editable.commands,{insertOrderedList:{title:"Numbered List",icon:"fa fa-list-ol",refresh:function(){},callback:function(e){this.formatList(e)},undo:!0},insertUnorderedList:{title:"Bulleted List",icon:"fa fa-list-ul",refresh:function(){},callback:function(e){this.formatList(e)},undo:!0}}),e.Editable.prototype.refreshLists=function(){var t=e(this.getSelectionElement()),i=this.parents(t,"ul, ol");if(i.length>0){var a="insertUnorderedList";"OL"==i[0].tagName&&(a="insertOrderedList"),this.$editor.find('button[data-cmd="'+a+'"]').addClass("active")}},e.Editable.prototype.processBackspace=function(t){var i=t.prev();if(i.length){for(this.removeMarkers(),("UL"==i.get(0).tagName||"OL"==i.get(0).tagName)&&(i=i.find("li:last"));i.find("> ul, > ol").length;)i=i.find("> ul li:last, > ol li:last");var a=i.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote");if(0===i.text().length&&0===i.find("img, table, input, iframe, video").length)i.remove();else{if(this.emptyElement(i.get(0))||(this.keep_enter=!0,t.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote").each(function(t,i){e(i).replaceWith(e(i).html())}),this.keep_enter=!1),a.length)if(e(a[a.length-1]).append(this.markers_html),0===t.find("ul, ol").length)e(a[a.length-1]).append(t.html());else{for(var l=!1,n=t.contents(),r=0;r<n.length;r++){var o=n[r];["OL","UL"].indexOf(n[r].tagName)>=0&&(l=!0),l?e(a[a.length-1]).after(o):e(a[a.length-1]).append(o)}this.$element.find("breakli").remove();var s=a[a.length-1].nextSibling;s&&"BR"==s.tagName&&e(s).remove()}else this.emptyElement(i.get(0))?(this.$element.find("breakli").replaceWith(this.markers_html),i.html(t.html())):(i.append(this.markers_html),i.append(t.html()));t.remove(),this.cleanupLists(),this.restoreSelectionByMarkers()}this.$element.find("breakli").remove()}else this.$element.find("breakli").remove(),this.parents(t,"ul").length?this.formatList("insertUnorderedList",!1):this.formatList("insertOrderedList",!1);this.sync()},e.Editable.prototype.liBackspace=function(){if(""!==this.text())return!0;var t,i=this.getSelectionElement(),a=this.parents(e(i),"table, li");if(a.length>0&&"TABLE"===a[0].tagName)return!0;if(t="LI"==i.tagName?e(i):this.parents(e(i),"li:first"),this.removeMarkers(),this.emptyElement(t.get(0))?(t.prepend("<breakli></breakli>"),1==t.find("br").length&&t.find("br").remove()):this.insertHTML("<breakli></breakli>"),t.find("breakli").prev().length&&"TABLE"===t.find("breakli").prev().get(0).tagName&&t.find("breakli").next().length&&"BR"===t.find("breakli").next().get(0).tagName)return this.setSelection(t.find("breakli").prev().find("td:first").get(0)),t.find("breakli").next().remove(),this.$element.find("breakli").remove(),!1;for(var l,n=t.html(),r=[],o=0;o<n.length;o++){if(chr=n.charAt(o),"<"!=chr)return this.$element.find("breakli").remove(),!0;var s=n.indexOf(">",o+1);if(-1!==s){l=n.substring(o,s+1);var d=this.tagName(l);if(o=s,"breakli"==d){if(!this.isClosingTag(l)&&!this.isClosingTag(r[r.length-1]))return this.processBackspace(t),!1}else r.push(l)}}return this.$element.find("breakli").remove(),!0},e.Editable.prototype.textLiEnter=function(t){this.removeMarkers(),this.insertSimpleHTML("<breakli></breakli>",!1);var i,a,l=t.html(),n=[],r={},o=[],s=0,d=t.prop("attributes"),c="";for(a=0;a<d.length;a++)c+=" "+d[a].name+'="'+d[a].value+'"';var g=!1;for(a=0;a<l.length;a++)if(chr=l.charAt(a),"<"==chr){var p=l.indexOf(">",a+1);if(-1!==p){i=l.substring(a,p+1);var u=this.tagName(i);if(a=p,"breakli"==u){if(!this.isClosingTag(i)){for(var m=n.length-1;m>=0;m--){var h=this.tagName(n[m]);o.push("</"+h+">")}o.push("</li>"),o.push("<li"+c+">");for(var f=0;f<n.length;f++)o.push(n[f]);o.push('<span class="f-marker" data-type="false" data-collapsed="true" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-collapsed="true" data-id="0" data-fr-verified="true"></span>'),g=!1}}else if(o.push(i),g=!1,!this.isSelfClosingTag(i))if(this.isClosingTag(i)){var b=r[u].pop();n.splice(b,1)}else n.push(i),void 0===r[u]&&(r[u]=[]),r[u].push(n.length-1)}}else s++,32!=chr.charCodeAt(0)||g?(o.push(chr),g=!0):o.push("&nbsp;");var I=e(t.parents("ul, ol")[0]);t.replaceWith("<li"+c+">"+o.join("")+"</li>"),I.find("p:empty + table").prev().remove(),I.find("p + table").each(function(t,i){var a=e(i);a.prev().append(a.clone()),a.remove()}),I.find("table + p").each(function(t,i){var a=e(i);a.append(a.prev().clone()),a.prev().remove()}),this.keep_enter=!0,I.find(this.valid_nodes.join(",")).each(e.proxy(function(t,i){""===e(i).text().trim()&&0===e(i).find(this.valid_nodes.join(",")).length&&e(i).prepend(e.Editable.INVISIBLE_SPACE)},this)),this.keep_enter=!1},e.Editable.prototype.liEnter=function(){var t,i=this.getSelectionElement(),a=this.parents(e(i),"table, li");if(a.length>0&&"TABLE"==a[0].tagName)return!0;if(t="LI"==i.tagName?e(i):this.parents(e(i),"li:first"),this.getSelectionTextInfo(t.get(0)).atStart&&""===this.text())t.before("<li>"+e.Editable.INVISIBLE_SPACE+"</li>");else{if(0===this.trim(t.text()).length&&0===t.find("img, table, iframe, input, object").length)return this.outdent(!1),!1;this.textLiEnter(t),this.$element.find("breakli").remove(),this.restoreSelectionByMarkers()}return this.sync(),!1},e.Editable.prototype.listTab=function(){var t=e(this.getSelectionElement());return this.parents(t,"ul, ol").length>0&&0===this.parents(t,"table").length?(this.indent(),!1):void 0},e.Editable.prototype.listShiftTab=function(){var t=e(this.getSelectionElement());return this.parents(t,"ul, ol").length>0&&0===this.parents(t,"table").length?(this.outdent(),!1):void 0},e.Editable.prototype.indentList=function(e,t){return"LI"===e.get(0).tagName?(t?this.outdentLi(e):this.indentLi(e),this.cleanupLists(),!1):!0},e.Editable.prototype.initList=function(){this.addListener("tab",this.listTab),this.addListener("shift+tab",this.listShiftTab),this.addListener("refresh",this.refreshLists),this.addListener("indent",this.indentList),this.isImage||this.isLink||this.options.editInPopup||this.$element.on("keypress",e.proxy(function(t){if(["TEXTAREA","INPUT"].indexOf(t.target.tagName)<0&&!this.isHTML){var i=t.which,a=this.getSelectionElement();if("LI"==a.tagName||this.parents(e(a),"li").length>0){if(13==i&&!t.shiftKey&&this.options.multiLine)return this.liEnter();if(8==i)return this.liBackspace()}}},this))},e.Editable.initializers.push(e.Editable.prototype.initList),e.Editable.prototype.formatList=function(t,i){if(this.browser.msie&&e.Editable.getIEversion()<9)return document.execCommand(t,!1,!1),!1;void 0===i&&(i=!0);var a,l,n=!1,r=!0,o=!1,s=this.getSelectionElements(),d=this.parents(e(s[0]),"ul, ol");if(d.length&&("UL"===d[0].tagName?"insertUnorderedList"!=t&&(n=!0):"insertOrderedList"!=t&&(n=!0)),this.saveSelectionByMarkers(),n){a="ol","insertUnorderedList"===t&&(a="ul");var c=e(d[0]);c.replaceWith("<"+a+">"+c.html()+"</"+a+">")}else{for(var g=0;g<s.length;g++)if(l=e(s[g]),("TD"==l.get(0).tagName||"TH"==l.get(0).tagName)&&this.wrapTextInElement(l),this.parents(l,"li").length>0||"LI"==l.get(0).tagName){var p;p="LI"==l.get(0).tagName?l:e(l.parents("li")[0]);var u=this.parents(l,"ul, ol");if(u.length>0&&(a=u[0].tagName.toLowerCase(),p.before('<span class="close-'+a+'" data-fr-verified="true"></span>'),p.after('<span class="open-'+a+'" data-fr-verified="true"></span>')),0===this.parents(e(u[0]),"ol, ul").length||n)if(0===p.find(this.valid_nodes.join(",")).length){var m=p.html().replace(/\u200B/gi,"");this.options.paragraphy?(0===p.text().replace(/\u200B/gi,"").length&&(m+=p.find("br").length>0?"":this.br),m="<"+this.options.defaultTag+this.attrs(p.get(0))+">"+m,m=m+"</"+this.options.defaultTag+">"):m+=p.find("br").length>0?"":this.br,p.replaceWith(m)}else p.replaceWith(p.html().replace(/\u200B/gi,""));else this.parents(e(u[0]),"ol, ul").length>0&&(p.append('<span class="open-li" data-fr-verified="true"></span>'),p.before('<span class="close-li" data-fr-verified="true"></span>'));o=!0}else r=!1;o&&this.cleanupLists(),(r===!1||n===!0)&&(this.wrapText(),this.restoreSelectionByMarkers(),s=this.getSelectionElements(),this.saveSelectionByMarkers(),this.elementsToList(s,t),this.unwrapText(),this.cleanupLists())}this.options.paragraphy&&!n&&this.wrapText(!0),this.restoreSelectionByMarkers(),i&&this.repositionEditor(),t="insertUnorderedList"==t?"unorderedListInserted":"orderedListInserted",this.triggerEvent(t)},e.Editable.prototype.elementsToList=function(t,i){var a="<ol>";"insertUnorderedList"==i&&(a="<ul>"),t[0]==this.$element.get(0)&&(t=this.$element.find("> "+this.valid_nodes.join(", >")));for(var l=0;l<t.length;l++){var n=e(a);$element=e(t[l]),$element.get(0)!=this.$element.get(0)&&("TD"===$element.get(0).tagName||"TH"===$element.get(0).tagName?(this.wrapTextInElement($element,!0),this.elementsToList($element.find("> "+this.valid_nodes.join(", >")),i)):(""===$element.attr("class")&&$element.removeAttr("class"),n.append(e("<li>").html($element.get(0).tagName==this.options.defaultTag&&0===$element.get(0).attributes.length?$element.clone().html():$element.clone())),$element.replaceWith(n)))}},e.Editable.prototype.indentLi=function(t){var i=t.parents("ul, ol"),a=i.get(0).tagName.toLowerCase();t.find("> ul, > ol").length>0&&t.prev("li").length>0?(this.wrapTextInElement(t),t.find("> "+this.valid_nodes.join(" , > ")).each(function(t,i){e(i).wrap("<"+a+"></"+a+">").wrap("<li></li>")}),t.prev("li").append(t.find("> ul, > ol")),t.remove()):0===t.find("> ul, > ol").length&&t.prev("li").length>0&&(t.prev().append(e("<"+a+">").append(t.clone())),t.remove(),e(i.find("li").get().reverse()).each(function(t,i){var a=e(i);a.find(" > ul, > ol").length>0&&a.prev()&&a.prev().find(" > ul, > ol").length>0&&1===a.contents().length&&(a.prev().append(a.html()),a.remove())}))},e.Editable.prototype.outdentLi=function(t){var i=e(t.parents("ul, ol")[0]),a=this.parents(i,"ul, ol"),l=i.get(0).tagName.toLowerCase();0===t.prev("li").length&&this.parents(t,"li").length>0?(t.before('<span class="close-'+l+'" data-fr-verified="true"></span>'),t.before('<span class="close-li" data-fr-verified="true"></span>'),t.before('<span class="open-li" data-fr-verified="true"></span>'),t.after('<span class="open-'+l+'" data-fr-verified="true"></span>'),t.replaceWith(t.html())):(t.before('<span class="close-'+l+'" data-fr-verified="true"></span>'),t.after('<span class="open-'+l+'" data-fr-verified="true"></span>'),this.parents(t,"li").length>0&&(t.before('<span class="close-li" data-fr-verified="true"></span>'),t.after('<span class="open-li" data-fr-verified="true"></span>'))),a.length||(0===t.find(this.valid_nodes.join(",")).length?t.replaceWith(t.html().replace(/\u200b/gi,"")+this.br):(t.find(this.valid_nodes.join(", ")).each(e.proxy(function(t,i){this.emptyElement(i)&&e(i).append(this.br)},this)),t.replaceWith(t.html().replace(/\u200b/gi,""))))},e.Editable.prototype.listTextEmpty=function(t){var i=e(t).text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return(""===i||t===this.$element.get(0))&&1===e(t).find("br").length}}(jQuery);