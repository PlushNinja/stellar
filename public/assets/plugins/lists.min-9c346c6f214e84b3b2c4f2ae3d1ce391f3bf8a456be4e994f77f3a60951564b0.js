/*!
 * froala_editor v1.2.8 (https://www.froala.com/wysiwyg-editor)
 * License https://www.froala.com/wysiwyg-editor/terms
 * Copyright 2014-2015 Froala Labs
 */
!function(e){e.Editable.commands=e.extend(e.Editable.commands,{insertOrderedList:{title:"Numbered List",icon:"fa fa-list-ol",refresh:function(){},callback:function(e){this.formatList(e)},undo:!0},insertUnorderedList:{title:"Bulleted List",icon:"fa fa-list-ul",refresh:function(){},callback:function(e){this.formatList(e)},undo:!0}}),e.Editable.prototype.refreshLists=function(){var t=e(this.getSelectionElement()),i=this.parents(t,"ul, ol");if(i.length>0){var n="insertUnorderedList";"OL"==i[0].tagName&&(n="insertOrderedList"),this.$editor.find('button[data-cmd="'+n+'"]').addClass("active")}},e.Editable.prototype.processBackspace=function(t){var i=t.prev();if(i.length){for(this.removeMarkers(),("UL"==i.get(0).tagName||"OL"==i.get(0).tagName)&&(i=i.find("li:last"));i.find("> ul, > ol").length;)i=i.find("> ul li:last, > ol li:last");var n=i.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote");if(0===i.text().length&&0===i.find("img, table, input, iframe, video").length)i.remove();else{if(this.emptyElement(i.get(0))||(this.keep_enter=!0,t.find("> p, > h1, > h3, > h4, > h5, > h6, > div, > pre, > blockquote").each(function(t,i){e(i).replaceWith(e(i).html())}),this.keep_enter=!1),n.length)if(e(n[n.length-1]).append(this.markers_html),0===t.find("ul, ol").length)e(n[n.length-1]).append(t.html());else{for(var o=!1,a=t.contents(),r=0;r<a.length;r++){var s=a[r];["OL","UL"].indexOf(a[r].tagName)>=0&&(o=!0),o?e(n[n.length-1]).after(s):e(n[n.length-1]).append(s)}this.$element.find("breakli").remove();var l=n[n.length-1].nextSibling;l&&"BR"==l.tagName&&e(l).remove()}else this.emptyElement(i.get(0))?(this.$element.find("breakli").replaceWith(this.markers_html),i.html(t.html())):(i.append(this.markers_html),i.append(t.html()));t.remove(),this.cleanupLists(),this.restoreSelectionByMarkers()}this.$element.find("breakli").remove()}else this.$element.find("breakli").remove(),this.parents(t,"ul").length?this.formatList("insertUnorderedList",!1):this.formatList("insertOrderedList",!1);this.sync()},e.Editable.prototype.liBackspace=function(){if(""!==this.text())return!0;var t,i=this.getSelectionElement(),n=this.parents(e(i),"table, li");if(n.length>0&&"TABLE"===n[0].tagName)return!0;if(t="LI"==i.tagName?e(i):this.parents(e(i),"li:first"),this.removeMarkers(),this.emptyElement(t.get(0))?(t.prepend("<breakli></breakli>"),1==t.find("br").length&&t.find("br").remove()):this.insertHTML("<breakli></breakli>"),t.find("breakli").prev().length&&"TABLE"===t.find("breakli").prev().get(0).tagName&&t.find("breakli").next().length&&"BR"===t.find("breakli").next().get(0).tagName)return this.setSelection(t.find("breakli").prev().find("td:first").get(0)),t.find("breakli").next().remove(),this.$element.find("breakli").remove(),!1;for(var o,a=t.html(),r=[],s=0;s<a.length;s++){if(chr=a.charAt(s),"<"!=chr)return this.$element.find("breakli").remove(),!0;var l=a.indexOf(">",s+1);if(-1!==l){o=a.substring(s,l+1);var d=this.tagName(o);if(s=l,"breakli"==d){if(!this.isClosingTag(o)&&!this.isClosingTag(r[r.length-1]))return this.processBackspace(t),!1}else r.push(o)}}return this.$element.find("breakli").remove(),!0},e.Editable.prototype.textLiEnter=function(t){this.removeMarkers(),this.insertSimpleHTML("<breakli></breakli>",!1);var i,n,o=t.html(),a=[],r={},s=[],l=0,d=t.prop("attributes"),h="";for(n=0;n<d.length;n++)h+=" "+d[n].name+'="'+d[n].value+'"';var p=!1;for(n=0;n<o.length;n++)if(chr=o.charAt(n),"<"==chr){var c=o.indexOf(">",n+1);if(-1!==c){i=o.substring(n,c+1);var u=this.tagName(i);if(n=c,"breakli"==u){if(!this.isClosingTag(i)){for(var f=a.length-1;f>=0;f--){var m=this.tagName(a[f]);s.push("</"+m+">")}s.push("</li>"),s.push("<li"+h+">");for(var g=0;g<a.length;g++)s.push(a[g]);s.push('<span class="f-marker" data-type="false" data-collapsed="true" data-id="0" data-fr-verified="true"></span><span class="f-marker" data-type="true" data-collapsed="true" data-id="0" data-fr-verified="true"></span>'),p=!1}}else if(s.push(i),p=!1,!this.isSelfClosingTag(i))if(this.isClosingTag(i)){var v=r[u].pop();a.splice(v,1)}else a.push(i),void 0===r[u]&&(r[u]=[]),r[u].push(a.length-1)}}else l++,32!=chr.charCodeAt(0)||p?(s.push(chr),p=!0):s.push("&nbsp;");var b=e(t.parents("ul, ol")[0]);t.replaceWith("<li"+h+">"+s.join("")+"</li>"),b.find("p:empty + table").prev().remove(),b.find("p + table").each(function(t,i){var n=e(i);n.prev().append(n.clone()),n.remove()}),b.find("table + p").each(function(t,i){var n=e(i);n.append(n.prev().clone()),n.prev().remove()}),this.keep_enter=!0,b.find(this.valid_nodes.join(",")).each(e.proxy(function(t,i){""===e(i).text().trim()&&0===e(i).find(this.valid_nodes.join(",")).length&&e(i).prepend(e.Editable.INVISIBLE_SPACE)},this)),this.keep_enter=!1},e.Editable.prototype.liEnter=function(){var t,i=this.getSelectionElement(),n=this.parents(e(i),"table, li");if(n.length>0&&"TABLE"==n[0].tagName)return!0;if(t="LI"==i.tagName?e(i):this.parents(e(i),"li:first"),this.getSelectionTextInfo(t.get(0)).atStart&&""===this.text())t.before("<li>"+e.Editable.INVISIBLE_SPACE+"</li>");else{if(0===this.trim(t.text()).length&&0===t.find("img, table, iframe, input, object").length)return this.outdent(!1),!1;this.textLiEnter(t),this.$element.find("breakli").remove(),this.restoreSelectionByMarkers()}return this.sync(),!1},e.Editable.prototype.listTab=function(){var t=e(this.getSelectionElement());return this.parents(t,"ul, ol").length>0&&0===this.parents(t,"table").length?(this.indent(),!1):void 0},e.Editable.prototype.listShiftTab=function(){var t=e(this.getSelectionElement());return this.parents(t,"ul, ol").length>0&&0===this.parents(t,"table").length?(this.outdent(),!1):void 0},e.Editable.prototype.indentList=function(e,t){return"LI"===e.get(0).tagName?(t?this.outdentLi(e):this.indentLi(e),this.cleanupLists(),!1):!0},e.Editable.prototype.initList=function(){this.addListener("tab",this.listTab),this.addListener("shift+tab",this.listShiftTab),this.addListener("refresh",this.refreshLists),this.addListener("indent",this.indentList),this.isImage||this.isLink||this.options.editInPopup||this.$element.on("keypress",e.proxy(function(t){if(["TEXTAREA","INPUT"].indexOf(t.target.tagName)<0&&!this.isHTML){var i=t.which,n=this.getSelectionElement();if("LI"==n.tagName||this.parents(e(n),"li").length>0){if(13==i&&!t.shiftKey&&this.options.multiLine)return this.liEnter();if(8==i)return this.liBackspace()}}},this))},e.Editable.initializers.push(e.Editable.prototype.initList),e.Editable.prototype.formatList=function(t,i){if(this.browser.msie&&e.Editable.getIEversion()<9)return document.execCommand(t,!1,!1),!1;void 0===i&&(i=!0);var n,o,a=!1,r=!0,s=!1,l=this.getSelectionElements(),d=this.parents(e(l[0]),"ul, ol");if(d.length&&("UL"===d[0].tagName?"insertUnorderedList"!=t&&(a=!0):"insertOrderedList"!=t&&(a=!0)),this.saveSelectionByMarkers(),a){n="ol","insertUnorderedList"===t&&(n="ul");var h=e(d[0]);h.replaceWith("<"+n+">"+h.html()+"</"+n+">")}else{for(var p=0;p<l.length;p++)if(o=e(l[p]),("TD"==o.get(0).tagName||"TH"==o.get(0).tagName)&&this.wrapTextInElement(o),this.parents(o,"li").length>0||"LI"==o.get(0).tagName){var c;c="LI"==o.get(0).tagName?o:e(o.parents("li")[0]);var u=this.parents(o,"ul, ol");if(u.length>0&&(n=u[0].tagName.toLowerCase(),c.before('<span class="close-'+n+'" data-fr-verified="true"></span>'),c.after('<span class="open-'+n+'" data-fr-verified="true"></span>')),0===this.parents(e(u[0]),"ol, ul").length||a)if(0===c.find(this.valid_nodes.join(",")).length){var f=c.html().replace(/\u200B/gi,"");this.options.paragraphy?(0===c.text().replace(/\u200B/gi,"").length&&(f+=c.find("br").length>0?"":this.br),f="<"+this.options.defaultTag+this.attrs(c.get(0))+">"+f,f=f+"</"+this.options.defaultTag+">"):f+=c.find("br").length>0?"":this.br,c.replaceWith(f)}else c.replaceWith(c.html().replace(/\u200B/gi,""));else this.parents(e(u[0]),"ol, ul").length>0&&(c.append('<span class="open-li" data-fr-verified="true"></span>'),c.before('<span class="close-li" data-fr-verified="true"></span>'));s=!0}else r=!1;s&&this.cleanupLists(),(r===!1||a===!0)&&(this.wrapText(),this.restoreSelectionByMarkers(),l=this.getSelectionElements(),this.saveSelectionByMarkers(),this.elementsToList(l,t),this.unwrapText(),this.cleanupLists())}this.options.paragraphy&&!a&&this.wrapText(!0),this.restoreSelectionByMarkers(),i&&this.repositionEditor(),t="insertUnorderedList"==t?"unorderedListInserted":"orderedListInserted",this.triggerEvent(t)},e.Editable.prototype.elementsToList=function(t,i){var n="<ol>";"insertUnorderedList"==i&&(n="<ul>"),t[0]==this.$element.get(0)&&(t=this.$element.find("> "+this.valid_nodes.join(", >")));for(var o=0;o<t.length;o++){var a=e(n);$element=e(t[o]),$element.get(0)!=this.$element.get(0)&&("TD"===$element.get(0).tagName||"TH"===$element.get(0).tagName?(this.wrapTextInElement($element,!0),this.elementsToList($element.find("> "+this.valid_nodes.join(", >")),i)):(""===$element.attr("class")&&$element.removeAttr("class"),a.append(e("<li>").html($element.get(0).tagName==this.options.defaultTag&&0===$element.get(0).attributes.length?$element.clone().html():$element.clone())),$element.replaceWith(a)))}},e.Editable.prototype.indentLi=function(t){var i=t.parents("ul, ol"),n=i.get(0).tagName.toLowerCase();t.find("> ul, > ol").length>0&&t.prev("li").length>0?(this.wrapTextInElement(t),t.find("> "+this.valid_nodes.join(" , > ")).each(function(t,i){e(i).wrap("<"+n+"></"+n+">").wrap("<li></li>")}),t.prev("li").append(t.find("> ul, > ol")),t.remove()):0===t.find("> ul, > ol").length&&t.prev("li").length>0&&(t.prev().append(e("<"+n+">").append(t.clone())),t.remove(),e(i.find("li").get().reverse()).each(function(t,i){var n=e(i);n.find(" > ul, > ol").length>0&&n.prev()&&n.prev().find(" > ul, > ol").length>0&&1===n.contents().length&&(n.prev().append(n.html()),n.remove())}))},e.Editable.prototype.outdentLi=function(t){var i=e(t.parents("ul, ol")[0]),n=this.parents(i,"ul, ol"),o=i.get(0).tagName.toLowerCase();0===t.prev("li").length&&this.parents(t,"li").length>0?(t.before('<span class="close-'+o+'" data-fr-verified="true"></span>'),t.before('<span class="close-li" data-fr-verified="true"></span>'),t.before('<span class="open-li" data-fr-verified="true"></span>'),t.after('<span class="open-'+o+'" data-fr-verified="true"></span>'),t.replaceWith(t.html())):(t.before('<span class="close-'+o+'" data-fr-verified="true"></span>'),t.after('<span class="open-'+o+'" data-fr-verified="true"></span>'),this.parents(t,"li").length>0&&(t.before('<span class="close-li" data-fr-verified="true"></span>'),t.after('<span class="open-li" data-fr-verified="true"></span>'))),n.length||(0===t.find(this.valid_nodes.join(",")).length?t.replaceWith(t.html().replace(/\u200b/gi,"")+this.br):(t.find(this.valid_nodes.join(", ")).each(e.proxy(function(t,i){this.emptyElement(i)&&e(i).append(this.br)},this)),t.replaceWith(t.html().replace(/\u200b/gi,""))))},e.Editable.prototype.listTextEmpty=function(t){var i=e(t).text().replace(/(\r\n|\n|\r|\t|\u200B)/gm,"");return(""===i||t===this.$element.get(0))&&1===e(t).find("br").length}}(jQuery);