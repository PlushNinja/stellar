(function(){var t,r,e;t=$("#paybyway-data").data("payUrl"),e=$("#paybyway-data").data("verifyUrl"),r=function(t){return $(".working").collapse("hide"),$("#message-failure").find(".alert").text($("#messages").data(t)),$("#message-failure").collapse("show"),$("button",".pay-now-button").attr("disabled",!1),$(".pay-now-button").collapse("show")},$("#paybyway-creditcard-form").on("submit",function(t){var a;return t.preventDefault(),$("button",".pay-now-button").attr("disabled",!0),$(".pay-now-button").collapse("hide"),$(".working").collapse("show"),$("#message-failure").collapse("hide"),a=$.get($(this).attr("action")),a.done(function(t){var n,o,u,c,i,l,s;try{if(s=t.token,n=t.amount,null==s)throw"token request failure";return l=$("#number").val().replace(/ /g,""),i=$("#expiry").payment("cardExpiryVal"),o=$("#cvc").val(),a=$.post(t.payment_url,{token:s,amount:n,currency:t.currency,card:l,exp_month:i.month<10?"0"+i.month:i.month,exp_year:i.year,security_code:o}),a.done(function(t){var a;return a=$.post(e,{token:s}),a.done(function(){return $("#checkout-form").trigger("submit.rails")}),a.fail(function(){return r("chargeError")})}),a.error(function(t){return r("chargeError")})}catch(c){return u=c,r("tokenRequestError")}})}),$(".bank-button").on("click",function(e){var a;return a=$.get(t,{selected:$(this).data("selected")}),a.done(function(t){var e,a,n;try{return n=$("<form></form>").attr("action",t.payment_url).attr("method","GET"),$("body").append(n),n.submit()}catch(a){return e=a,r("tokenRequestError")}})})}).call(this);