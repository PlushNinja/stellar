%table.main{width: '100%', cellpadding: 0, cellspacing: 0}
  %tr
    %td.content-wrap.aligncenter
      %table{width: '100%', cellpadding: 0, cellspacing: 0}
        %tr
          %td.content-block
            %div= image_tag @store.cover_image.url(:matchbox)
            %h1
              = t('.title')
              %span.small
                \#
                = @order.to_s
        %tr
          %td.content-block
            %h2= t('.thank_you', store: @store)
        %tr
          %td.content-block
            %table.invoice
              %tr
                %td
                  %table{width: '100%', cellpadding: 0, cellspacing: 5}
                    %tr
                      %td= Order.human_attribute_name(:customer_name)
                      %td
                        %b= @order.customer_name
                      %td= Order.human_attribute_name(:customer_phone)
                      %td
                        %b= @order.customer_phone
                    - if @order.has_shipping?
                      %tr
                        %td= Order.human_attribute_name(:shipping_at)
                        %td
                          %b= @order.shipping_at.present? ? l(@order.shipping_at) : ''
                      %tr
                        %td
                          = Order.human_attribute_name(:billing_address)
                        %td
                          %b= @order.billing_address
                          %br
                          %b= @order.billing_postalcode
                          %b= @order.billing_city
                        %td
                          = Order.human_attribute_name(:shipping_address)
                        %td
                          %b= @order.shipping_address
                          %br
                          %b= @order.shipping_postalcode
                          %b= @order.shipping_city
                    - @order.shipments.each do |shipment|
                      %tr
                        %td
                          = Order.human_attribute_name(:shipping_method)
                        %td
                          %b= shipment.shipping_method.name
                    %tr
                      %td= Order.human_attribute_name(:order_type_id)
                      %td
                        %b= @order.order_type
                      %td= Order.human_attribute_name(:message)
                      %td
                        %b= @order.message
                    %tr
                      %td= Order.human_attribute_name(:your_reference)
                      %td
                        %b= @order.your_reference
                      %td= Order.human_attribute_name(:our_reference)
                      %td
                        %b= @order.our_reference
                    %tr
                      %td
                        = Order.human_attribute_name(:notes)
                      %td{colspan: 3}
                        = @order.notes
              %tr
                %td
                  %table.invoice-items{cellpadding: 5, cellspacing: 0}
                    %caption.alignright
                      %em= @order.includes_tax? ? t('orders.receipt.tax_included') : t('orders.receipt.tax_excluded')
                    %tr
                      %td= OrderItem.human_attribute_name(:product_code)
                      %td= OrderItem.human_attribute_name(:product_title)
                      %td.alignright= OrderItem.human_attribute_name(:amount)
                      %td.alignright= OrderItem.human_attribute_name(:price)
                      %td.alignright= OrderItem.human_attribute_name(:subtotal)
                    - @order.order_items.each do |order_item|
                      = content_tag_for :tr, order_item do
                        %td= order_item.product_code
                        %td
                          %b= order_item.product_title
                          = order_item.product_subtitle
                          - if order_item.product.vendor.present?
                            .small
                              = "#{Product.human_attribute_name(:vendor_id)}:"
                              = order_item.product.vendor.name
                          - if order_item.product.shipping_notes.present?
                            .small
                              %em= order_item.product.shipping_notes
                        %td.alignright.nowrap= order_item.amount
                        %td.alignright.nowrap
                          = humanized_money_with_symbol order_item.includes_tax? ? order_item.price_with_tax : order_item.price_sans_tax
                        %td.alignright.nowrap
                          = humanized_money_with_symbol order_item.includes_tax? ? order_item.subtotal_with_tax : order_item.subtotal_sans_tax
                    %tr.total
                      %td.alignright{colspan: 4}
                        = Order.human_attribute_name(:grand_total)
                      %td.alignright.nowrap
                        = humanized_money_with_symbol @order.includes_tax? ? @order.grand_total_with_tax : @order.grand_total_sans_tax
              %tr
                %td
                  %table.invoice-items{cellpadding: 5, cellspacing: 0}
                    %tr
                      %td= TaxCategory.human_attribute_name(:rate)
                      %td.alignright= Order.human_attribute_name(:total_sans_tax)
                      %td.alignright= Order.human_attribute_name(:tax_total)
                      %td.alignright= Order.human_attribute_name(:total_with_tax)
                    - @order.order_items.group_by(&:tax_rate).each do |tax_rate, items|
                      %tr
                        %td= number_to_percentage tax_rate, precision: 0
                        %td.alignright.nowrap
                          = humanized_money_with_symbol @order.grand_total_sans_tax(items)
                        %td.alignright.nowrap
                          = humanized_money_with_symbol @order.tax_total(items)
                        %td.alignright.nowrap
                          = humanized_money_with_symbol @order.grand_total_with_tax(items)
                    %tr
                      %th.alignright.nowrap= Order.human_attribute_name(:grand_total)
                      %th.alignright.nowrap
                        = humanized_money_with_symbol @order.grand_total_sans_tax
                      %th.alignright.nowrap
                        = humanized_money_with_symbol @order.tax_total
                      %th.alignright.nowrap
                        = humanized_money_with_symbol @order.grand_total_with_tax

.footer
  %table{width: '100%'}
    %tr
      %td.content-block{width: 70}
        %p= image_tag 'stellar-vertical.svg', width: 50
      %td.content-block
        %p= t('footer.heading')
        = t('footer.body_html')
