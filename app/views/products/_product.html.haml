- cache [current_group, I18n.locale, :product_card, product] do
  %li.masonry-item.single[product]{class: !product.orderable?(current_inventory) && 'out-of-stock'}
    = link_to show_product_path(product, @category), data: {push: 'partial', target: '#store-body'} do
      .product-image= image_variant_tag product.cover_image(current_store.card_image_type), :postcard
      .product-text
        %h3
          = product.title
          %span.small= product.subtitle
        .description= product.description
      .promotions
        - product.live_promoted_items(current_group).each do |item|
          .promotion= item.description
      - if pricing_shown? && premium_pricing.present?
        .premium-price
          %span.teaser= current_group.premium_teaser
          %p.price.currency
            = price_tag *premium_pricing.for_display(product)
    .buy-now
      - if pricing_shown?
        %p.price.currency
          - if product.has_variants?
            = price_range *pricing.range_for_display(product)
          - else
            = price_tag *pricing.for_display(product)
      - if can_order? && may_shop_at?(@category)
        - if product.has_variants? && product.visible?
          .product-link
            = link_to icon('search'), show_product_path(product, @category), class: 'btn btn-sm', data: {push: 'partial', target: '#store-body'}
        - elsif product.purchasable?
          - if product.orderable?(current_inventory)
            = form_tag order_product_path(product), method: :post, remote: true, class: 'form-inline buy-now-form' do
              = hidden_field_tag :amount, 1
              %button.btn.btn-success.btn-sm{type: 'submit'}= icon('cart-plus')
          - else
            %p.text-danger
              = icon('exclamation-circle')
              = col(Product, :out_of_stock)
