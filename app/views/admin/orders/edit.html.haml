.page-header
  = link_to admin_orders_path, class: 'btn btn-default' do
    = icon('chevron-circle-left', t('actions.back'))
  = link_to admin_order_path(@order), class: 'btn btn-primary' do
    = icon('info-circle', t('actions.show'))
  %h1
    = @order.order_type
    %span.small= @order.to_s

.row
  .col-lg-5
    = render partial: 'form', locals: {locked: false}

  .col-lg-7
    = tab_set 'order-side', class: 'nav-justified nav-sm' do
      = nav_tab 'order-items', title(OrderItem, count: 2), default: true
      = nav_tab 'shipments', title(Shipment, count: 2)
      = nav_tab 'payments', title(Payment, count: 2)

    .tab-content
      = tab_pane 'order-items', default: true, class: 'page-break' do
        %h2.visible-print-block= title(OrderItem, count: 2)
        - if @order.editable_items?
          = render partial: 'admin/order_items/edit_table', object: @order, as: :order
          = render partial: 'admin/orders/edit', object: @order, as: :order
        - else
          = render partial: 'admin/order_items/table', object: @order, as: :order

      = tab_pane 'shipments' do
        %h2.visible-print-block= title(Shipment, count: 2)
        #shipments-list
          = render partial: 'admin/shipments/item', collection: @order.shipments, as: :shipment, locals: {locked: @order.concluded?}
        - if current_user.can_create?(Shipment, for: @order, at: current_store)
          = render partial: 'admin/shipments/new', object: @order, as: :order

      = tab_pane 'payments' do
        %h2.visible-print-block= title(Payment, count: 2)
        = render partial: 'admin/payments/table', object: @order, as: :order

:coffee
  persist_tabs 'order-side'
