.quick-edit-panel
  .panel.panel-primary
    .panel-heading
      .pull-right
        .panel-error-indicator= icon('warning')
      %h4.panel-title
        = t('.add_transfer_items')
    .panel-body
      %fieldset#admin-barcode-panel.bg-info
        .form-group
          .input-group.input-group-lg
            %span.input-group-addon= icon('barcode')
            = text_field_tag 'barcode', nil, class: 'form-control monospace'
        .form-group
          = select_tag 'categories', options_for_select(current_group.category_options), multiple: true, placeholder: col(Product, :category_ids)
      = render partial: 'admin/transfer_items/new', object: transfer, as: :transfer

:coffee
  $('#barcode').switchboard
    formats:
      '1': 'GS1-128'
    mapping:
      'Dead': String.fromCharCode(29) # ctrl-] to FNC1
    callbacks:
      'GS1-128': (code) ->
        data = parseBarcode "]C1\#{code}"
        console.log data

        $('#barcode').val(code).select().effect 'highlight'

  $('#categories').selectize
    plugins: ['remove_button']
    dropdownParent: 'body'
    allowEmptyOption: true
    onChange: (id) ->
      $('#transfer_item_product_id')[0].selectize.clearOptions()
