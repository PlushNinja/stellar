= form_tag lookup_path, method: :get, class: 'navbar-form', role: 'search' do
  .form-group
    = search_field_tag 'keyword', nil, autocomplete: 'off', class: 'form-control', placeholder: t('store.lookup')
  #lookup-dropdown.dropdown-menu
    .lookup-results
      %ul.category-results.media-list
      %ul.product-results.media-list
      %ul.page-results.media-list

:coffee
  $('#navbar-lookup').on 'shown.bs.collapse', (e) ->
    $('#navbar-lookup input').focus()
    $('#lookup-open').hide()
    $('#lookup-close').show()
  $('#navbar-lookup').on 'hidden.bs.collapse', (e) ->
    $('#lookup-close').hide()
    $('#lookup-open').show()
  $('#side-nav').on 'shown.offcanvas', (e) ->
    $('#navbar-lookup').collapse 'hide'
  $('#navbar-lookup > form').on 'submit', (e) ->
    e.preventDefault()
  $('#keyword').smartkeyup (e) ->
    q = $(this).val().replace /^\s+|\s+$/g, ''
    if e.keyCode is 27
      $('#navbar-lookup').collapse 'hide'
    else if q?.length > 1
      $.get '#{lookup_path}?keyword=' + encodeURIComponent(q)
    else
      $('#lookup-dropdown').hide 'fade'
