(function(){var t,e,r;t=$("#paybyway-data").data("pay-url"),r=$("#paybyway-data").data("verify-url"),e=function(t){return $(".working").collapse("hide"),$("#message-failure").find(".alert").text($("messages").data(t)),$("#message-failure").collapse("show"),$("button",".pay-now-button").attr("disabled",!1),$(".pay-now-button").collapse("show")},$("#paybyway-creditcard-form").on("submit",function(t){var a;return t.preventDefault(),$("button",".pay-now-button").attr("disabled",!0),$(".pay-now-button").collapse("hide"),$(".working").collapse("show"),$("#message-failure").collapse("hide"),a=$.get($(this).attr("action")),a.done(function(t){var n,o,u,c,i,l;try{if(l=t.token,n=t.amount,null==l)throw"token request failure";return i=$("#number").val().replace(/ /g,""),c=$("#expiry").payment("cardExpiryVal"),o=$("#cvc").val(),a=$.post(t.payment_url,{token:l,amount:n,currency:t.currency,card:i,exp_month:c.month<10?"0"+c.month:c.month,exp_year:c.year,security_code:o}),a.done(function(t){var a;return a=$.post(r,{token:l}),a.done(function(){return $("#checkout-form").trigger("submit.rails")}),a.fail(function(){return e("charge_error")})}),a.error(function(t){return e("charge_error")})}catch(s){return u=s,e("token_request_error")}})}),$(".bank-button").on("click",function(r){var a;return a=$.get(t,{selected:$(this).data("selected")}),a.done(function(t){var r,a;try{return a=$("<form></form>").attr("action",t.payment_url).attr("method","GET"),$("body").append(a),a.submit()}catch(n){return r=n,e("token_request_error")}})})}).call(this);