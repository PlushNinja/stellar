= form_for @search, url: show_category_path(@category), method: :get, enforce_utf8: false, data: {push: 'partial', target: '#store-body', 'optimize-url-params': false}, html: {id: 'filter-form'} do |f|
  %nav.navbar.navbar-default.filter-bar
    .navbar-header
      .navbar-form.navbar-form-inline
        .form-group.has-feedback
          = f.search_field :keyword, placeholder: t('search_panel.keyword'), class: 'form-control'
          %span.form-control-feedback= icon('search')
      %button.navbar-toggle.collapsed{type: 'button', data: {toggle: 'collapse', target: '#filter-nav'}}
        = icon('caret-down')
    #filter-nav.collapse.navbar-collapse
      %ul.nav.navbar-nav
        - current_store.searchable_properties.each do |property|
          = render partial: 'properties/filter_menu', object: property, as: :property, locals: {search: @search, param: property.sluggify, values: property.values_for(@category.self_and_maybe_descendants), selected: @search.options[property.sluggify]}

:coffee
  $('#filter-form').on 'change', (e) ->
    $(this).submit()
