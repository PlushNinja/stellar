:ruby
  order_types = current_user.outgoing_order_types

.pull-right
  = link_to t('store.go_checkout'), checkout_path(order), id: 'checkout-button', class: 'btn btn-primary', disabled: order.order_type.nil?
- if order_types.count > 1
  .pull-right
    = form_tag order_type_path(order), method: :post, remote: true, id: 'order-type-form', class: 'immediate' do
      .btn-group{data: {toggle: 'buttons'}}
        - order_types.each do |order_type|
          %label.btn.btn-default{class: order_type == order.order_type ? 'active' : ''}
            = radio_button_tag :order_type_id, order_type.id, order_type == order.order_type
            = order_type.name
  :coffee
    $('#order-type-form').on 'change', (e) ->
      if $(e.target)
        $('#checkout-button').attr 'disabled', false

- elsif order_types.count == 1
  :coffee
    jQuery ->
      request = $.post '#{order_type_path(order)}',
        order_type_id: #{order_types.first.id}
      request.done (data) ->
        $('#checkout-button').attr 'disabled', false
