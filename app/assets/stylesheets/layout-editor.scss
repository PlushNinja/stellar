/*
 * Layout editor side panel
 */
#side-panel {
  display: block;
  left: -1*$navmenu-width;
  z-index: 1019; // just below #side-nav
  transform: translateX(0);
  transform: translateX(0) translateZ(0);
  transition: 0.15s ease all;
  backface-visibility: hidden;
  -webkit-overflow-scrolling: touch;
}
#side-panel.open {
  transform: translateX($navmenu-width);
  transform: translateX($navmenu-width) translateZ(0);
  @include box-shadow(0 0 12px 0 rgba(0,0,0,0.5));
}
#side-panel .panel-toggle {
  margin-top: 10px;
  margin-bottom: 10px;
}
#side-panel .inner-wrap {
  padding-left: 15px;
  padding-right: 15px;
}


/*
 * Layout editor sections and segments
 */
.section-list {
  position: relative;
  padding-bottom: 600px;
}
.section-list-item { position: relative; }
.section-list-item.loading {
  height: 200px;
  background-color: rgba(0, 0, 0, 0.8);

  .spinner {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    color: #fff;
  }
}
.section-list-item .section-bg-container:before {
  content: '';
  pointer-events: none;
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-top: 1px solid rgba($brand-primary, 0.333);
  border-bottom: 1px solid rgba($brand-primary, 0.333);
}
.section-list-item .section-nav {
  position: absolute;
  top: 0;
  left: 0;
  border: 0;
  border-radius: 0;

  > .navbar-nav {
    float: left !important;
    margin-left: 0;
    margin-right: 0;

    > li { float: left !important; }
  }
}
.section-list-item .column {
  position: relative;

  &:before {
    content: '';
    pointer-events: none;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-left: 1px solid rgba($gray-base, 0.1667);
    border-right: 1px solid rgba($gray-base, 0.1667);
  }
  .column-nav {
    position: absolute;
    bottom: 0;
    left: 0;
    margin-bottom: 0;
    border: 0;
    border-radius: 0;
    opacity: 0;
    transition: all 0.4s ease-in-out 0s;
  }
}
.section-list-item .column:hover {
  &:before { border-width: 0 3px; }

  .column-nav {
    z-index: 1;
    opacity: 1;
  }
}
.section-list-item .segment.active,
.section-list-item .segment.disabled {
  .segment-content { outline: none; }
  .segment-nav { display: none !important; }
}
.section-list-item .segment {
  position: relative;

  &:before {
    content: '';
    pointer-events: none;
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border: 1px solid rgba($brand-info, 0.333);
  }
  .segment-nav {
    position: absolute;
    top: 0;
    right: 0;
    min-height: 40px;
    border: 0;
    border-radius: 0;
    opacity: 0;
    transition: all 0.4s ease-in-out 0s;
    background-color: darken($brand-info, 15%);

    .navbar-nav {
      display: flex;
      flex-flow: row wrap;
      justify-content: flex-end;
    }
    .navbar-nav > li > a,
    .navbar-nav > li input {
      color: lighten($brand-info, 25%);
      &:hover, &:focus { color: #fff; }
    }
    .navbar-nav > li > a {
      padding: 10px 11px;
    }
    .dropdown-menu {
      width: 260px;
      border: 0;
      border-radius: 0;

      form { padding: 15px; }
    }
    .dropdown-menu-right { width: 180px; }
  }
  .segment-content-wrap { pointer-events: none; }
}
.section-list-item .segment:hover {
  &:before { border-width: 3px; }
  .segment-content { min-height: 40px; }
  .segment-nav {
    z-index: 2;
    opacity: 1;
  }
}


/*
 * Layout panel for in-place editing of segments
 */
#layout-panel {
  @extend .col-xs-10, .col-sm-6, .col-md-4;
  position: absolute;
  top: 200px;
  right: 10%;
  z-index: 2;
  padding: 0;
  background-color: $body-bg;
  line-height: 1.4; // matches layouts.css
}
#layout-panel .panel-close {
  display: block;
  position: absolute;
  top: -45px;
  right: -41px;
  z-index: 1;
  padding: 11.5px 14px 12px 14.5px;
  font-size: 24px;
  line-height: 1;
  border: 1px solid $panel-default-border;
  border-radius: 25px;
  color: inherit;
  background-color: #fff;
  box-shadow: 0 0 6px rgba(0,0,0,0.2);

  &:hover { background-color: #f0f0f0; }
}
#layout-panel:before {
  content: '';
  position: absolute;
  left: -15px;
  right: -15px;
  top: -20px;
  bottom: 0;
  z-index: -1;
  background-color: $body-bg;
  @include box-shadow(0 0 12px rgba(0, 0, 0, 0.8));
}
#layout-panel .segment-form,
#layout-panel .segment-head,
#layout-panel .segment-tail {
  padding-bottom: 20px;
}
#layout-panel .CodeMirror { height: 300px; }

/* Overrides for different segment templates */
#layout-panel .segment-form.text .note-editor {
  border: 0;
  border-radius: 0;
  caret-color: $brand-primary;

  .note-editing-area .note-editable,
  .note-editing-area .note-placeholder {
    padding: 0;

    h1:first-child,
    h2:first-child,
    h3:first-child {
      margin-top: 0;
    }
  }
  .table { @extend .table-bordered; }
  font[color] { text-shadow: 0 0 1px rgba(0, 0, 0, 0.6); }
}
